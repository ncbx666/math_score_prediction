# üéì–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∞—è –£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å: –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –û—Ü–µ–Ω–æ–∫ –ø–æ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–µ

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —É—á–µ–Ω–∏–∫–æ–≤. –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–º –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∏ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.

## üóÇÔ∏è–î–∞–Ω–Ω—ã–µ

–î–∞—Ç–∞—Å–µ—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 8 —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —Ç–∞–∫–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏:

- **–≥–µ–Ω–¥–µ—Ä** ‚Äî –ø–æ–ª —É—á–µ–Ω–∏–∫–∞ (–º–µ—Ç–æ–¥ —ç–Ω–∫–æ–¥–∏–Ω–≥–∞ OHE).
- **—Ä–∞—Å–∞** ‚Äî —Ä–∞—Å–æ–≤–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å (OHE).
- **–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–π** ‚Äî —É—Ä–æ–≤–µ–Ω—å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π (LabelEncoding).
- **–ª–∞–Ω—á** ‚Äî —Ç–∏–ø –ª–∞–Ω—á–∞ (LabelEncoding).
- **–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫–∑–∞–º–µ–Ω—É** ‚Äî –ø—Ä–æ—Ö–æ–¥–∏–ª –ª–∏ —É—á–µ–Ω–∏–∫ –∫—É—Ä—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —ç–∫–∑–∞–º–µ–Ω—É (0 ‚Äî –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª, 1 ‚Äî –ø—Ä–æ—Ö–æ–¥–∏–ª).
- **–æ—Ü–µ–Ω–∫–∞ –ø–æ —á—Ç–µ–Ω–∏—é** ‚Äî –±–∞–ª–ª—ã –∑–∞ —á—Ç–µ–Ω–∏–µ.
- **–æ—Ü–µ–Ω–∫–∞ –ø–æ –ø–∏—Å—å–º—É** ‚Äî –±–∞–ª–ª—ã –∑–∞ –ø–∏—Å—å–º–æ.

–¶–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫: **–æ—Ü–µ–Ω–∫–∞ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ** ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–µ—Ç—å –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å.

## üîß–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ —á–∏—Å–ª–µ–Ω–Ω—ã–µ:

- –ü—Ä–∏–∑–Ω–∞–∫–∏ **–≥–µ–Ω–¥–µ—Ä** –∏ **—Ä–∞—Å–∞** –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é One-Hot Encoding (OHE).
- –ü—Ä–∏–∑–Ω–∞–∫–∏ **–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–π** –∏ **–ª–∞–Ω—á** –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é Label Encoding.
- –ü—Ä–∏–∑–Ω–∞–∫ **–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫–∑–∞–º–µ–Ω—É** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –±–∏–Ω–∞—Ä–Ω–æ–π —Ñ–æ—Ä–º–µ (0 –∏ 1).

## üèóÔ∏è–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `torch.nn`. –§—É–Ω–∫—Ü–∏—è `create_model()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:

- **hid_size1** ‚Äî —Ä–∞–∑–º–µ—Ä –ø–µ—Ä–≤–æ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 32).
- **n_features** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏).
- **n_out** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–æ–¥–∏–Ω ‚Äî –æ—Ü–µ–Ω–∫–∞ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ).

```python
import torch.nn as nn

def create_model(hid_size1=32, n_features=NUM_FEATURES, n_out=NUM_OUT):
    model = nn.Sequential()
    model.add_module('l1', nn.Linear(n_features, hid_size1))
    model.add_module('activation1', nn.ReLU())
    model.add_module('l2', nn.Linear(hid_size1, n_out))
    return model
```
## üöÄ–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ `SGD` –∏ —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ—Ç–µ—Ä—å `MSELoss`. –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ —ç–ø–æ—Ö–∞–º, –≥–¥–µ –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é –±–µ—Ä—É—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–µ –±–∞—Ç—á–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ–±–æ–±—â–∞–µ–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.

### –ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è

```python
import torch
import numpy as np

def train_model(model, x_train, y_train):
    loss_function = nn.MSELoss()
    opt = torch.optim.SGD(model.parameters(), lr=0.00001)

    loss_history = []
    for num_of_epoch in range(NUM_EPOCH):
        opt.zero_grad()

        # –í—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ –±–∞—Ç—á–∞ –∏–∑ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
        random_indices = np.random.choice(np.arange(len(x_train)), size=32)
        x_train_batch = x_train[random_indices]
        y_train_batch = y_train[random_indices]

        # –ü—Ä–æ–≥–Ω–æ–∑ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
        y_predicted = model(x_train_batch).view(-1)
        loss = loss_function(y_predicted, y_train_batch)

        loss_history.append(loss.item())

        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏
        loss.backward()
        opt.step()

  return model, loss_history
```
## üîç–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω—è—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ `MSELoss` –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∞—Ö. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å –æ–±—É—á–∏–ª–∞—Å—å –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω–∞ –æ–±–æ–±—â–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

### –ö–æ–¥ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ MSE

```python
def calculate_mse(model, x_data, y_data):
    model.eval()  #–ø–µ—Ä–µ–≤–µ–ª–∏ –º–æ–¥–µ–ª—å –≤ —Ä–µ–∂–∏–º –æ—Ü–µ–Ω–∫–∏
    with torch.no_grad():  #–æ—Ç–∫–ª—é—á–∞–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
        y_predicted = model(x_data).view(-1)
        mse = F.mse_loss(y_predicted, y_data)
    return mse.item()

train_mse = calculate_mse(trained_model, x_train, y_train)
test_mse = calculate_mse(trained_model, x_test, y_test)

```

## üìä–†–µ–∑—É–ª—å—Ç–∞—Ç—ã
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ü–µ–Ω–∫–∏ –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∞—Ö –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è MSE:

**Training MSE:** 29.875001907348633

**Testing MSE:** 26.76482580292285

–ù–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –æ—à–∏–±–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –æ–±—É—á–∞—é—â–µ–π –æ—à–∏–±–∫–æ–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ö–æ—Ä–æ—à—É—é –æ–±–æ–±—â–∞–µ–º–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∏ –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–¥–µ–ª—å –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∏–ª–∞—Å—å.

–¢–∞–∫–∂–µ –±—ã–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –∏ —ç–ø–æ—Ö–∏ –æ–±—É—á–µ–Ω–∏—è:
![image](https://github.com/user-attachments/assets/b3824784-e0c4-48a1-a76d-eb9b5643bec8)

